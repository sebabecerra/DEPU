---
title: "Untitled"
author: "Sebastán Becerra"
date: "21-09-2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


```{r fig.align='center', message=FALSE, warning=FALSE, include=FALSE, out.width=, paged.print=FALSE}
fig1 <- plot_ly(depu, y = ~depuc_ma_30, x=~date, name = 'DEPUC', type="scatter", mode="lines", line = list(color = "orange", width = 4),hoverinfo = 'text', text = ~paste('</br> Fecha: ', format(date, "%d%b%Y"),'</br> Valor: ', format(round(depuc_ma_30,2),nsmall=2))) %>% layout(legend = list(orientation = "h", xanchor = "center", x = 0.5, y=1), xaxis = list(title = "", showgrid = F,  type="date", tickangle=0, showline = F, tick0="2012-01-01", dtick="M12",  tickformat="<br>%y",range=c("2011-11-01","2020-10-31")),yaxis = list(title = " ", side="left",range=c(-1,3),dtick=1,showgrid = F,zerolinecolor ="black", zerolinewidth = 1.5, zeroline = T, ticksuffix=" ", tickformat = ".1f"),                            shapes=list(list(type='line', x0= "2012-01-16", x1= "2012-01-16", y0=-1, y1=3, line  =list (dash='dot', width=4, color="gray"), opacity = 0.3),
list(type='line', x0= "2012-04-30", x1= "2012-05-05", y0=-1, y1=3, line=list(dash='dot', width=4, color="gray"), opacity = 0.3),
list(type='line', x0= "2013-06-30", x1= "2013-06-21", y0=-1, y1=3, line=list(dash='dot', width=4, color="gray"), opacity = 0.3),
list(type='line', x0= "2013-11-21", x1= "2013-11-21", y0=-1, y1=3, line=list(dash='dot', width=4, color="gray"), opacity = 0.3),
list(type='line', x0= "2014-05-14", x1= "2014-05-14", y0=-1, y1=3, line=list(dash='dot', width=4, color="gray"), opacity = 0.3),
list(type='line', x0= "2014-09-10", x1= "2014-09-10", y0=-1, y1=3, line=list(dash='dot', width=4, color="gray"), opacity = 0.3),
list(type='line', x0= "2017-12-31", x1= "2017-12-31", y0=-1, y1=3, line=list(dash='dot', width=4, color="gray"), opacity = 0.3),
list(type='line', x0= "2018-06-16", x1= "2018-06-16", y0=-1, y1=3,   line=list(dash='dot', width=4, color="gray"), opacity = 0.3),
list(type='line', x0= "2019-06-15", x1= "2019-06-15", y0=-1, y1=3, line=list(dash='dot', width=4, color="gray"), opacity = 0.3),
list(type='line', x0= "2020-01-22", x1= "2020-01-22", y0=-1, y1=3, line=list(dash='dot', width=4, color="gray"), opacity = 0.3),
list(type="rect", fillcolor="gray", line = list(color = "white"),x0="2019-10-20", x1="2020-01-01", y0=-1, y1=3, opacity=0.4, layer="below"),
list(type="rect", fillcolor="gray", line = list(color = "white"),x0="2020-03-10", x1="2020-06-26", y0=-1, y1=3, opacity=0.4, layer="below")), 
annotations = list(list(text = "Crisis deuda<br>Europea",  x = "2012-01-16", y = 0.7,showarrow=T, xanchor="left"),list( text="Proy. Reforma<br>tributaria", x="2012-04-30", y=2, showarrow=T, xanchor="rigth"),list(text = "Eleciones<br>primarias",  x = "2013-06-30", y = 1.5,showarrow=T, xanchor="left"),list(text = "Elecciones<br>2da. vuelta",  x = "2013-11-21", y = 0.8,showarrow=T, xanchor="left"),list(text = "Aprob. Reforma<br>tributaria",  x = "2014-05-14", y = 2,showarrow=T, xanchor="left"),list(text = "Ataque explosivo<br>metro Santiago",  x = "2014-09-10", y = 1,showarrow=T, xanchor="left"),list(text = "Elecciones<br>2da. vuelta",  x = "2017-12-31", y = 0.5,showarrow=T, xanchor="left"),list(text = "China-US guerra<br>comercial",  x = "2018-06-16", y = 1.8,showarrow=T, xanchor="center"),list(text = "CLP/USD<br>700",  x = "2019-06-15", y = 0.7,showarrow=T, xanchor="rigth")
,list(text = "O-18",  x = "2019-12-01", y = 1.1,showarrow=T, xanchor="rigth"),list(text = "Wuhan bajo<br>cuarentena",  x = "2020-01-24", y = 1.6,showarrow=T, xanchor="rigth"),list(text = "IMACEC<br>May<br>(-15%)",  x = "2020-06-01", y = 1.7,showarrow=T, xanchor="rigth", ax=3,ay =78),list(text = "10%",  x = "2020-07-08", y = 1.85,showarrow=T, xanchor="rigth",ax=-8,ay=-28), list(text = "Santiago levanta <br> cuarentena <br> (143 días)",  x = "2020-08-12", y = 2,showarrow=T, xanchor="rigth", ax=-45,ay =-78),  list(text = "IPoM",  x = "2020-09-02", y = 1.25,showarrow=T, xanchor="rigth", ax=5,ay =-28)))  %>% config(modeBarButtonsToRemove = c("zoom2d", "pan2d", "select2d", "lasso2d", "zoomIn2d", "zoomOut2d", "autoScale2d", "resetScale2d", "hoverClosestCartesian", "hoverCompareCartesian", "zoom3d", "pan3d", "resetCameraDefault3d", "resetCameraLastSave3d", "hoverClosest3d", "orbitRotation", "tableRotation", "zoomInGeo", "zoomOutGeo", "resetGeo", "hoverClosestGeo", "sendDataToCloud", "hoverClosestGl2d", "hoverClosestPie", "toggleHover", "resetViews", "toggleSpikelines", "resetViewMapbox"),displaylogo = FALSE)
fig1
```